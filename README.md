# lanchonete

Software criado para pós graduação FIAP

1. [Project Description](#lanchonete)
2. [Coverage Status](#coverage-status)
3. [Run in Postman](#run-in-postman)
4. [Miro Board for Event Storming and Storytelling](#miro-board-para-event-storming-e-storytelling)
5. [Application Routes Documentation](#documentação-de-rotas-da-aplicaçao)
6. [Database Documentation](#documentação-do-banco-de-dados)
7. [Installation](#installation)
8. [Usage](#usage)
   - [Kubernetes](#kubernetes)
     - [Kubernetes Development](#kubernetes-development)
   - [Docker Compose](#docker-compose)
   - [Clojure](#clojure)
9. [ZAP OWASP Scan](#zap-owasp-scan)
10. [License](#license)

[![Coverage Status](https://coveralls.io/repos/github/kschltz/lanchonete/badge.svg?branch=feat/nats-posting)](https://coveralls.io/github/kschltz/lanchonete?branch=feat/nats-posting)

[![Run in Postman](https://run.pstmn.io/button.svg)](https://app.getpostman.com/run-collection/7462440-796f2919-cc85-47d9-af25-6d5b3828aa38?action=collection%2Ffork&source=rip_markdown&collection-url=entityId%3D7462440-796f2919-cc85-47d9-af25-6d5b3828aa38%26entityType%3Dcollection%26workspaceId%3D89237b62-8986-4c78-81a4-725c13c2db8e#?env%5B%5Bdev%5D%20lanchonete%5D=W3sia2V5IjoiY2F0ZWdvcmlhIiwidmFsdWUiOiJsYW5jaGUiLCJlbmFibGVkIjp0cnVlLCJ0eXBlIjoiZGVmYXVsdCJ9LHsia2V5IjoiaG9zdCIsInZhbHVlIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwLyIsImVuYWJsZWQiOnRydWUsInR5cGUiOiJkZWZhdWx0In0seyJrZXkiOiJwcm9kdWN0X2lkIiwidmFsdWUiOiIiLCJlbmFibGVkIjp0cnVlLCJ0eXBlIjoiYW55In0seyJrZXkiOiJjbGllbnRlX2lkIiwidmFsdWUiOiIiLCJlbmFibGVkIjp0cnVlLCJ0eXBlIjoiZGVmYXVsdCJ9XQ==)

ps: caso tenha problema para rodar os testes diretamente pelo link acima, a collection pode ser acessada tbm por este [link](https://www.postman.com/cloudy-spaceship-8629/workspace/pos-fiap/collection/7462440-796f2919-cc85-47d9-af25-6d5b3828aa38?action=share&creator=7462440&active-environment=7462440-a3f44872-cf4b-4e3e-8a28-8a1dee94f395) ou ainda diretamente pelo arquivo neste [link](https://1drv.ms/f/s!ArHPKY_La1NFiKUY6SFT0c88iZI3mA?e=ZDs4fj)

obs: não esquecer de ativar o ambiente dev no postman

### Miro Board para Event Storming e Storytelling

[miro](https://miro.com/app/board/uXjVMg_qpOA=/?share_link_id=776193048301)

### Documentação de Rotas da aplicaçao

[doc](/doc/routes.md)

### Documentação do banco de dados

[doc](/doc/database.md)

## Installation

Download from <https://github.com/kschltz/lanchonete>

## Usage

### Kubernetes

You can run/deploy the project in Kubernetes using the following command:

    kubectl apply -f k8s/postgre/ && kubectl apply -f k8s/lanchonete/

#### kubernetes development

If you are using minikube you can run the following helper script to start a fresh minikube and load everything you need:

        ./bin/minikube-ground-up.sh

It will:

- 1 - Delete the current minikube
- 2 - Create a new minikube
- 3 - build the app image
- 4 - load de image
- 5 - apply the k8s files
- 7 - enable the metrics addon
- 8 - open up minikube tunnel for connectivity

##### You can see what the generated artifacts look like in the architecture diagrams

[architecture documentation](/doc/architecture.md)

### Docker compose

From the root of the project, run:

    docker-compose up --build

### Clojure

Run the project in dev environment:

    clojure -A:dev:test

Run the project directly, via `:main-opts` (`-m mba-fiap.lanchonete`):

    clojure -M:run-m

Run the project's tests:

    clojure -T:build test

Run the project's CI pipeline and build an uberjar:

    clojure -T:build ci

This will produce an updated `pom.xml` file with synchronized dependencies inside the `META-INF`
directory inside `target/classes` and the uberjar in `target`. You can update the version (and SCM tag)
information in generated `pom.xml` by updating `build.clj`.

If you don't want the `pom.xml` file in your project, you can remove it. The `ci` task will
still generate a minimal `pom.xml` as part of the `uber` task, unless you remove `version`
from `build.clj`.

Run that uberjar:

    java -jar target/lanchonete-0.1.0-SNAPSHOT.jar

## ZAP OWASP scan

Dentro da pasta `/doc/zap` temos um report gerado das rotas `[POST] /pedido` e `[GET] /produtos/lanche` após um scan do ZAP OWASP.

Não temos contexto no cenário atual do app de rotas expostas para pagamento, sendo assim, o contexto de pagamento não pode ser filtrado e analisado pelo ZAP OWASP.

Esse fluxo de pagamento está centralizado na arquitetura SAGA.

## License

Copyright © 2023 Kschltz

_EPLv1.0 is just the default for projects generated by `clj-new`: you are not_
_required to open source this project, nor are you required to use EPLv1.0!_
_Feel free to remove or change the `LICENSE` file and remove or update this_
_section of the `README.md` file!_

Distributed under the Eclipse Public License version 1.0.
